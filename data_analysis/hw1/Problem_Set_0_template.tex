\documentclass[11pt]{article}
%https://www.gradescope.com/help#help-center-item-answer-formatting-guide
\usepackage{graphicx}
\usepackage{wrapfig}
\usepackage{url}
\usepackage{wrapfig}
\usepackage{color}
\usepackage{marvosym}
\usepackage{enumerate}
\usepackage{subfigure}
\usepackage{tikz}
\usepackage[fleqn]{amsmath}
\usepackage{amssymb}
\usepackage{hyperref} 
\usepackage[many]{tcolorbox}
\usepackage{lipsum}
\usepackage{float}
\usepackage{trimclip}
\usepackage{listings}
\usepackage{environ}% http://ctan.org/pkg/environ
\usepackage{wasysym}
\usepackage{array}


\oddsidemargin 0mm
\evensidemargin 5mm
\topmargin -20mm
\textheight 240mm
\textwidth 160mm

\bgroup
\def\arraystretch{1.5}
\newcolumntype{x}[1]{>{\centering\arraybackslash\hspace{0pt}}p{#1}}
\newcolumntype{z}[1]{>{\centering\arraybackslash}m{#1}}



%Arguments are 1 - height, 2 - box title
\newtcolorbox{textanswerbox}[2]{%
 width=\textwidth,colback=white,colframe=blue!30!black,floatplacement=H,height=#1,title=#2,clip lower=true,before upper={\parindent0em}}
 
 \newtcolorbox{eqanswerbox}[1]{%
 width=#1,colback=white,colframe=black,floatplacement=H,height=3em,sharp corners=all,clip lower=true,before upper={\parindent0em}}
 
 %Arguments are 1 - height, 2 - box title
 \NewEnviron{answertext}[2]{
 	\noindent
	\marginbox*{0pt 10pt}{
  	\clipbox{0pt 0pt 0pt 0pt}{
	\begin{textanswerbox}{#1}{#2}
	\BODY
	\end{textanswerbox}
	}
	}
}

%Arguments are 1 - height, 2 - box title, 3 - column definition
 \NewEnviron{answertable}[3]{
 	\noindent
	\marginbox*{0pt 10pt}{
  	\clipbox{0pt 0pt 0pt 0pt}{
	\begin{textanswerbox}{#1}{#2}
		\vspace{-0.5cm}
        		\begin{table}[H]
        		\centering 
        		\begin{tabular}{#3}
        			\BODY
        		\end{tabular}
        		\end{table}
	\end{textanswerbox}
	}
	}
}

 %Arguments are 1 - height, 2 - box title, 3 - title, 4- equation label, 5 - equation box width
 \NewEnviron{answerequation}[5]{
 	\noindent
	\marginbox*{0pt 10pt}{
  	\clipbox{0pt 0pt 0pt 0pt}{
	\begin{textanswerbox}{#1}{#2}
		\vspace{-0.5cm}
        		\begin{table}[H]
        		\centering 
		\renewcommand{\arraystretch}{0.5}% Tighter

        		\begin{tabular}{#3}
        			#4 =	&
		  	\clipbox{0pt 0pt 0pt 0pt}{

			\begin{eqanswerbox}{#5}
				$\BODY$
			\end{eqanswerbox}
			} \\ 
        		\end{tabular}
        		\end{table}
		
	\end{textanswerbox}
	}
	}
}

 %Arguments are 1 - height, 2 - box title
 \NewEnviron{answerderivation}[2]{
 	\noindent
	\marginbox*{0pt 10pt}{
  	\clipbox{0pt 0pt 0pt 0pt}{
	\begin{textanswerbox}{#1}{#2}
	\BODY
	\end{textanswerbox}
	}
	}
}

\newcommand{\vwi}{{\bf w}_i}
\newcommand{\vw}{{\bf w}}
\newcommand{\vx}{{\bf x}}
\newcommand{\vy}{{\bf y}}
\newcommand{\vxi}{{\bf x}_i}
\newcommand{\yi}{y_i}
\newcommand{\vxj}{{\bf x}_j}
\newcommand{\vxn}{{\bf x}_n}
\newcommand{\yj}{y_j}
\newcommand{\ai}{\alpha_i}
\newcommand{\aj}{\alpha_j}
\newcommand{\X}{{\bf X}}
\newcommand{\Y}{{\bf Y}}
\newcommand{\vz}{{\bf z}}
\newcommand{\msigma}{{\bf \Sigma}}
\newcommand{\vmu}{{\bf \mu}}
\newcommand{\vmuk}{{\bf \mu}_k}
\newcommand{\msigmak}{{\bf \Sigma}_k}
\newcommand{\vmuj}{{\bf \mu}_j}
\newcommand{\msigmaj}{{\bf \Sigma}_j}
\newcommand{\pij}{\pi_j}
\newcommand{\pik}{\pi_k}
\newcommand{\D}{\mathcal{D}}
\newcommand{\el}{\mathcal{L}}
\newcommand{\N}{\mathcal{N}}
\newcommand{\vxij}{{\bf x}_{ij}}
\newcommand{\vt}{{\bf t}}
\newcommand{\yh}{\hat{y}}
\newcommand{\code}[1]{{\footnotesize \tt #1}}
\newcommand{\alphai}{\alpha_i}

\newcommand{\Checked}{{\LARGE \XBox}}%
\newcommand{\Unchecked}{{\LARGE \Square}}%
\newcommand{\TextRequired}{{\textbf{Place Answer Here}}}%
\newcommand{\EquationRequired}{\textbf{Type Equation Here}}%


\newcommand{\answertextheight}{5cm}
\newcommand{\answertableheight}{4cm}
\newcommand{\answerequationheight}{2.5cm}
\newcommand{\answerderivationheight}{14cm}

\newcounter{QuestionCounter}
\newcounter{SubQuestionCounter}[QuestionCounter]
\setcounter{SubQuestionCounter}{1}

\newcommand{\subquestiontitle}{Question \theQuestionCounter.\theSubQuestionCounter~}
\newcommand{\newquestion}{\stepcounter{QuestionCounter}\setcounter{SubQuestionCounter}{1}\newpage}
\newcommand{\newsubquestion}{\stepcounter{SubQuestionCounter}}


\lstset{language=[LaTeX]TeX,basicstyle=\ttfamily\bf}

\pagestyle{myheadings}
\markboth{Problem set 0}{Spring 2019 EN.601.448/648 Computational genomics: Problem set 0}


\title{EN.601.448/648 Computational genomics: Problem set 0}
\author{LuchaoQi (lqi9)} 
\date{} 



\begin{document}
\maketitle
\thispagestyle{headings}

\section*{Instructions } 
We have provided this \LaTeX{} document for turning in Problem set 0. We give you one or more boxes to answer each question.  The question to answer for each box will be noted in the title of the box.

 {\bf Other than your name, do not type anything outside the boxes. Leave the rest of the document unchanged.}
 
 For written answers, replace the \lstinline{\TextRequired} (\TextRequired) command with your answer. For the following example \textit{\subquestiontitle}, you would place your answer where \lstinline{\TextRequired} (\TextRequired) is located,

\begin{answertext}{1.5cm}{\subquestiontitle}
\TextRequired
\end{answertext}
\newsubquestion
 {\bf Do not change} the height or title of the box. If your text goes beyond the box boundary, it will be cut off.  We have given sufficient space for each answer, so please condense your answer if it overflows. The height of the box is an upper bound on the amount of text required to answer the question - many answers can be answered in a fraction of the space.  Do not add text outside of the boxes. We will not read it.
 
For True/False or Multiple Choice questions, place your answers within the defined table.  To mark the box(es) corresponding to your answers, replace \lstinline{\Unchecked} (\Unchecked) commands with the \lstinline{\Checked} (\Checked) command. Do not make any other changes to the table. For example, in \textit{\subquestiontitle},

\begin{answertable}{2.5cm}{\subquestiontitle}{x{0.5cm}p{5cm}}
\Checked &  Logistic Regression \\ 
\Unchecked & Perceptron \\     
\end{answertable}
\newsubquestion
For answers that require a single equation, we will provide a specific type of box, such as in the following example \textit{\subquestiontitle}.  Please type the equation where  \lstinline{\EquationRequired} (\EquationRequired) without adding any \$ signs or \lstinline{\equation} commands.  Do not put any additional text in this field.

\begin{answerequation}{\answerequationheight}{\subquestiontitle}{z{1cm}z{12cm}}{\textbf{w}}{12cm}
\EquationRequired
\end{answerequation}
\newsubquestion
For answers that require multiple equations, such as a derivation, place all equations within the specified box.   You may include text short explanations if you wish (as shown in \textit{\subquestiontitle}).  You can put the equations in any format you like (e.g. within \$ or \$\$, the \lstinline{\equation} environment, the \lstinline{\align} environment) as long as they stay within the box.

\begin{answerderivation}{6cm}{\subquestiontitle}
\begin{align*}
x + 2  && \text{x is a real number} \\
&&\text{the following equation uses the variable } y \\
y+3
\end{align*}
\end{answerderivation}
\newsubquestion
\begin{center}

\textbf{Do not change any formatting in this document, or we may be unable to grade your work. This includes but is not limited to the height of textboxes, font sizes, and the spacing of text and tables.  Additionally, do not add text outside of the answer boxes. Entering your answers are the only changes allowed.}


\textbf{We strongly recommend you review your answers in the generated PDF to ensure they appear correct. We will grade what appears in the answer boxes in the submitted PDF, NOT the original latex file.}
\end{center}


\newquestion

\section*{\arabic{QuestionCounter}. Expected value and likelihood (1 point) }
{

\renewcommand{\answertextheight}{2cm}
\begin{answertext}{\answertextheight}{\subquestiontitle }
$P(\text{30 tosses all yield heads})$ = $\theta^{30}\approx2.211*10^{-7}$
\end{answertext}
\newsubquestion

\begin{answertext}{\answertextheight}{\subquestiontitle }
$\mathbb{E}(\text{One toss})$ = $\theta = 0.6$
\end{answertext}
\newsubquestion

\begin{answertext}{\answertextheight}{\subquestiontitle }
$\mathbb{E}(\text{sum of 4 coin tosses})$ = $4*0.6=2.4$
\end{answertext}
\newsubquestion


\begin{answertext}{\answertextheight}{\subquestiontitle (a)}
Given $\theta = 0.5$, 
$\text{Likelihood}$ = $0.5^7*0.5^3\approx9.77*10^{-4}$
\end{answertext}

\begin{answertext}{\answertextheight}{\subquestiontitle (b)}
Given $\theta = 0.8$, 
$\text{Likelihood}$ =$0.8^7*0.2^3\approx1.68*10^{-3}$
\end{answertext}

\begin{answertable}{2.5cm}{\subquestiontitle (c) Which model do you prefer}{x{0.5cm}p{5cm}}
\Unchecked &  $\theta = 0.5$ \\ 
\Checked &  $\theta = 0.8$ \\ 
\end{answertable}

\renewcommand{\answertextheight}{4cm}
\begin{answertext}{\answertextheight}{\subquestiontitle (c) Justification}
The likelihood is larger when $\theta=0.8$, which means $\theta=0.8$ is better supported given the data.
\end{answertext}
\newsubquestion

\renewcommand{\answertextheight}{8cm}
\begin{answertext}{\answertextheight}{\subquestiontitle (d) Is there better setting?}
\begin{align}
    \mathcal{L}(\theta \vert x) &= \theta^7(1-\theta)^3\nonumber\\
    log\mathcal{L}(\theta \vert x) &= 7log(\theta)+3log(1-\theta)\nonumber\\
    \frac{log\mathcal{L}(\theta \vert x)}{dx} &= \frac{7}{\theta}-\frac{3}{1-\theta}=0\nonumber\\
    \theta &= 0.7\nonumber
\end{align}
    So we have MLE of $\theta$ if $\theta=0.7$
\end{answertext}

}


\newquestion

\section*{\arabic{QuestionCounter}. Probability and independence (0.5 points) }
{
\renewcommand{\answertextheight}{6cm}
\begin{answertext}{\answertextheight}{\subquestiontitle Prove}
\begin{align}
    P(A\vert B) &= \frac{P(AB)}{P(B)} > P(B)\label{a}
\end{align}
    With equation \ref{a}, we have:\\
\begin{align}
    P(B\vert A) &= \frac{P(AB)}{P(A)} > P(B)
\end{align}
\end{answertext}
\newsubquestion

\renewcommand{\answertextheight}{6cm}
\begin{answertable}{2.5cm}{\subquestiontitle (a.1) are these two events independent}{x{0.5cm}p{5cm}}
\Unchecked &  Yes \\ 
\Checked &  No \\ 
\end{answertable}

\begin{answertext}{\answertextheight}{\subquestiontitle (a.2) Justification}
Because \begin{align}
             P(AB) &= 8/25\nonumber\\
            P(A)*P(B)&= \frac{13}{25}*\frac{10}{25}\nonumber\\
            P(AB) &\neq P(A)*P(B)\nonumber
        \end{align}
So they are not independent.
\end{answertext}


\renewcommand{\answertextheight}{2cm}
\begin{answertext}{\answertextheight}{\subquestiontitle (b)}
$P = $$1-P(B\vert A)=1-\frac{8}{13}=\frac{5}{13}$
\end{answertext}


\begin{answertable}{2.5cm}{\subquestiontitle (c). which is more likely}{x{0.5cm}p{5cm}}
\Unchecked &  Steel \\ 
\Checked &  Wooden \\ 
\end{answertable}


}

\newquestion



\section*{\arabic{QuestionCounter}. Bayes' Theorem (0.5 points)}
{
\renewcommand{\answertextheight}{15cm}
\begin{answertext}{\answertextheight}{\subquestiontitle Probability of actually have the disease (write out the derivation)}
\begin{align}
    P(D|+)&=\frac{P(+|D)P(D)}{P(+|D)P(D)+P(+|D^C)P(D^C)}\nonumber\\
    &=\frac{P(+|D)P(D)}{P(+|D)P(D)+P(+|D^C)\left(1-P(D)\right)}\nonumber\\
    &=\frac{0.96*\frac{1}{250000}}{0.96*\frac{1}{250000}+0.005*\left(1-\frac{1}{250000}\right)}\nonumber\\
    &\approx7.67*10^{-4}\nonumber
\end{align}
\end{answertext}
}

\newquestion

\section*{\arabic{QuestionCounter}. Gaussian data and likelihood}
{

\renewcommand{\answertextheight}{2cm}
\begin{answertext}{\answertextheight}{\subquestiontitle }
$\mathbb{E}[\sum_{i=1}^{10} x_i]$ = $10*0 = 0$
\end{answertext}
\newsubquestion

\begin{answertext}{\answertextheight}{\subquestiontitle }
$E[\sum_{i=1}^{10} x_i^2]$ = $10*(1+0^2)=10$
\end{answertext}
\newsubquestion


\renewcommand{\answertextheight}{6cm}
\begin{answertext}{\answertextheight}{\subquestiontitle}
Actual ten values (3 signif digits): $1.16*10^{0}, -7.38*10^{-1}, -8.61*10^{-1}, 6.31*10^{-1},  -6.17*10^{-1}, 9.58*10^{-1}, -1.71*10^{0}, 1.31*10^{0}, 9.41*10^{-1}, 2.08*10^{0}$  \\
Sum $=$ 3.154 \\
Sum of squares $=$ 14.18
\end{answertext}
\newsubquestion

\renewcommand{\answertextheight}{3cm}
\begin{answertext}{\answertextheight}{\subquestiontitle}
$p(x_1) = $0.020 \\
$p(x_2) = $0.304 \\
$p(x_3) = $0.275
\end{answertext}
\newsubquestion

\renewcommand{\answertextheight}{2cm}
\begin{answertext}{\answertextheight}{\subquestiontitle}
$\text{Likelihood}(x_1, x_2, ... x_{10}) = $$2.86*10^{-7}$
\end{answertext}
\newsubquestion

\renewcommand{\answertextheight}{2cm}
\begin{answertext}{\answertextheight}{\subquestiontitle}
$\log \text{Likelihood}(x_1, x_2, ... x_{10}) = $$-0.153$
\end{answertext}

\renewcommand{\answertextheight}{4cm}
\begin{answertext}{\answertextheight}{\subquestiontitle Why might people prefer to work in log space?}
Taking logs typically makes log likelihoods better behaved. Also, it's easier to get maximum log likelihood than maximum likelihood.
\end{answertext}

}
\newquestion



\section*{\arabic{QuestionCounter}. Linear algebra (0.5 points)}
{
\renewcommand{\answertextheight}{2cm}
\begin{answertext}{\answertextheight}{\subquestiontitle A is orthonormal}
$A^TA$ is $A^{-1}A=I$ ,$I$ is indentity matrix.
\end{answertext}
\newsubquestion


\renewcommand{\answertextheight}{5cm}
\begin{answertext}{\answertextheight}{\subquestiontitle (a) If A is invertible write the inverse of A}
$A^{-1}=$
$$
\begin{bmatrix}
    \frac{1}{3}         &0              & \frac{1}{3}    \\
    -\frac{1}{6}       & \frac{1}{2}   & -\frac{1}{6} \\
    \frac{1}{6}       & -\frac{1}{2} & \frac{7}{6} 
\end{bmatrix}
$$
\end{answertext}

\begin{answertext}{\answertextheight}{\subquestiontitle (a) If A is not invertible write the justification}
\TextRequired
\end{answertext}

\renewcommand{\answertextheight}{5cm}
\begin{answertext}{\answertextheight}{\subquestiontitle (b) If A is invertible write the inverse of A}
$A^{-1}=$
$$
\begin{bmatrix}
    \TextRequired      & \TextRequired & \TextRequired\\
    \TextRequired       & \TextRequired & \TextRequired\\
    \TextRequired       & \TextRequired & \TextRequired 
\end{bmatrix}
$$
\end{answertext}

\begin{answertext}{\answertextheight}{\subquestiontitle (b) If A is not invertible write the justification}
The determinant of matrix is 0, so $A$ is not invertible.
\end{answertext}
\newsubquestion

\renewcommand{\answertextheight}{2cm}
\begin{answertext}{\answertextheight}{\subquestiontitle Implement the function in Python}
% No answer needed here
\end{answertext}
\newsubquestion

}
\newquestion





\section*{\arabic{QuestionCounter}. Matrix derivatives. (1 point)}
{

\renewcommand{\answertextheight}{8cm}
\begin{answertext}{\answertextheight}{\subquestiontitle Matrix derivative (write out the derivation)}
\begin{align}
    Q &= (Y-X\beta)^T(Y-X\beta)\nonumber\\
    &= Y^TY-2\beta X^TY+\beta X^TX\beta\nonumber\\
    \frac{dQ}{d\beta}&=-2X^TY+2X^TX\beta\nonumber
\end{align}

\end{answertext}
\newsubquestion

\renewcommand{\answertextheight}{8cm}
\begin{answertext}{\answertextheight}{\subquestiontitle Optimal $\beta$}
When $$  \frac{dQ}{d\beta} =  0 $$
     $$X^TX\beta   =  X^TY    $$\\
If the matrix $X^TX$ is invertible, we have:
$$
\beta=(X^TX)^{-1}X^TY
$$

\end{answertext}
\newsubquestion

\renewcommand{\answertextheight}{8cm}
\begin{answertext}{\answertextheight}{\subquestiontitle Unique solutions in linear regression}
$rank(X^TX)=rank(X^TX|X^TY)$ means we have solutions for $\beta$. \\
If and only if $N\geq K$ will the number of equations is larger than the number of variables, which means solution is unique\\

\end{answertext}
\newsubquestion


}



\end{document}
