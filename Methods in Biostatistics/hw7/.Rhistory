dat <- read.csv("task1.csv", header = FALSE)
dat2 <- dat[,1 : 10]
dat2 <- dat2[complete.cases(dat2),]
vec1 <- as.vector(unlist(dat2))
dat2
vec1
sum(dat2)
dat <- read.csv("task1.csv", header = FALSE)
dat2 <- dat[,1 : 10]
dat2 <- dat2[complete.cases(dat2),]
vec1 <- as.vector(unlist(dat2))
sum((dat2-5.5)^2/5.5)
summary(dat2)
dat2
size(dat2)
dat <- read.csv("task1.csv", header = FALSE)
dat2 <- dat[,1 : 10]
dat2 <- dat2[complete.cases(dat2),]
vec1 <- as.vector(unlist(dat2))
ts=sum((dat2-5.5)^2/5.5)
pchisq(ts,9*45,lower.tail = FALSE)
dat2
chisq.test(dat2)
dat <- read.csv("task1.csv", header = FALSE)
dat2 <- dat[,1 : 10]
dat2 <- dat2[complete.cases(dat2),]
vec1 <- as.vector(unlist(dat2))
ts=sum((dat2-5.5)^2/5.5)
pchisq(ts,9*45,lower.tail = FALSE)
chisq.test(dat2,incorrect = FALSE)
chisq.test(dat2,correct = FALSE)
?chisq.test
chisq.test(dat2,correct = TRUE)
chisq.test(dat2,correct = FALSE)
9*45
dat2
chisq.test(dat2,correct = FALSE)
dat <- read.csv("task1.csv", header = FALSE)
dat2 <- dat[,1 : 10]
dat2 <- dat2[complete.cases(dat2),]
vec1 <- as.vector(unlist(dat2))
ts=sum((dat2-5.5)^2/5.5)
pchisq(ts,9*45,lower.tail = FALSE)
chisq.test(dat2)
summary(dat2)
dat2
dat <- read.csv("task1.csv", header = FALSE)
dat2 <- dat[,1 : 10]
dat2 <- dat2[complete.cases(dat2),]
vec1 <- as.vector(unlist(dat2))
chisq.test(dat2)
simdat <- t(rmultinom(1000, size = length(vec1), p = rep(.1, 10)))
simdat <- t(rmultinom(1000, size = length(vec1), p = rep(.1, 10)))
chsqStats <- apply(simdat, 1, function(x) chisq.test(x)$statistic)
chisq.test(x)
chisq.test(c(1,2,3,4))
chisq.test(c(1,2,3,4))$statistic
simdat <- t(rmultinom(1000, size = length(vec1), p = rep(.1, 10)))
chsqStats <- apply(simdat, 1, function(x) chisq.test(x)$statistic)
simdat
mean(simdat)
sum(chsqStats[1]>simdat[1,:])
sum(chsqStats[1]>simdat(1,:))
sum(chsqStats[1]>simdat[1,1:10])
chsqStats
simdat <- t(rmultinom(1000, size = length(vec1), p = rep(.1, 10)))
chsqStats <- apply(simdat, 1, function(x) chisq.test(x)$statistic)
s=0
for (i in 1:1000) {
s=s+sum(chsqStats[i]>simdat[i,1:10])
}
sum(chsqStats[1]>simdat[1,1:10])
sum(chsqStats[2]>simdat[2,1:10])
sum(chsqStats[3]>simdat[3,1:10])
sum(chsqStats[4]>simdat[4,1:10])
simdat <- t(rmultinom(1000, size = length(vec1), p = rep(.1, 10)))
chsqStats <- apply(simdat, 1, function(x) chisq.test(x)$statistic)
s=0
for (i in 1:1000) {
s=s+sum(chsqStats[i]>simdat[i,1:10])
}
s/10000
simdat <- t(rmultinom(1000, size = length(vec1), p = rep(.1, 10)))
chsqStats <- apply(simdat, 1, function(x) chisq.test(x)$statistic)
s=0
for (i in 1:1000) {
s=s+sum(chsqStats[i]>simdat[i,1:10])
}
s/10000
simdat <- t(rmultinom(1000, size = length(vec1), p = rep(.1, 10)))
chsqStats <- apply(simdat, 1, function(x) chisq.test(x)$statistic)
s=0
for (i in 1:1000) {
s=s+sum(chsqStats[i]>simdat[i,1:10])
}
s/10000
simdat <- t(rmultinom(1000, size = length(vec1), p = rep(.1, 10)))
chsqStats <- apply(simdat, 1, function(x) chisq.test(x)$statistic)
s=0
for (i in 1:1000) {
s=s+sum(chsqStats[i]>simdat[i,1:10])
}
s/10000
simdat <- t(rmultinom(1000, size = length(vec1), p = rep(.1, 10)))
chsqStats <- apply(simdat, 1, function(x) chisq.test(x)$statistic)
s=0
for (i in 1:1000) {
s=s+sum(chsqStats[i]>simdat[i,1:10])
}
s/10000
simdat <- t(rmultinom(1000, size = length(vec1), p = rep(.1, 10)))
chsqStats <- apply(simdat, 1, function(x) chisq.test(x)$statistic)
s=0
for (i in 1:1000) {
s=s+sum(chsqStats[i]>simdat[i,1:10])
}
s/10000
simdat <- t(rmultinom(1000, size = length(vec1), p = rep(.1, 10)))
chsqStats <- apply(simdat, 1, function(x) chisq.test(x)$statistic)
s=0
for (i in 1:1000) {
s=s+sum(chsqStats[i]>simdat[i,1:10])
}
s/10000
simdat <- t(rmultinom(1000, size = length(vec1), p = rep(.1, 10)))
chsqStats <- apply(simdat, 1, function(x) chisq.test(x)$statistic)
s=0
for (i in 1:1000) {
s=s+sum(chsqStats[i]>simdat[i,1:10])
}
s/10000
simdat <- t(rmultinom(1000, size = length(vec1), p = rep(.1, 10)))
chsqStats <- apply(simdat, 1, function(x) chisq.test(x)$statistic)
s=0
for (i in 1:1000) {
s=s+sum(statistic[i]>simdat[i,1:10])
}
statistic
simdat <- t(rmultinom(1000, size = length(vec1), p = rep(.1, 10)))
chsqStats <- apply(simdat, 1, function(x) chisq.test(x)$statistic)
s=0
for (i in 1:1000) {
s=s+sum(chsqStats[i]>simdat[i,1:10])
}
s/10000
a=8*164/229+25*138/213+50*208/346
b=5*52/229+21*29/213+61*27/346
ts=a/b
dat=array(c(1,2,3,4))
dat
dat=matrix(c(1,2,3,4))
dat
dat=array((c(11, 10, 25, 27, 16, 22, 4, 10,
14, 7, 5, 12, 2, 1, 14, 16,
6, 0, 11, 12, 1, 0, 10, 10,
1, 1, 4, 8, 4, 6, 2, 1),
dat=array((c(11, 10, 25, 27, 16, 22, 4, 10,14, 7, 5, 12, 2, 1, 14, 16,6, 0, 11, 12, 1, 0, 10, 10,
1, 1, 4, 8, 4, 6, 2, 1),
dat=array((c(11, 10, 25, 27, 16, 22, 4, 10,14, 7, 5, 12, 2, 1, 14, 16,6, 0, 11, 12, 1, 0, 10, 10,
1, 1, 4, 8, 4, 6, 2, 1),
dat=array(c(11, 10, 25, 27, 16, 22, 4, 10,14, 7, 5, 12, 2, 1, 14, 16,6, 0, 11, 12, 1, 0, 10, 10,
1, 1, 4, 8, 4, 6, 2, 1),
c(2, 2, 8))
mantelhaen.test(dat, correct = FALSE)
dat
dat=array(c(8,52,5,164
25,29,21,138,
dat=array(c(8,52,5,164,
25,29,21,138,
50,27,61,208),
c(2, 2, 3))
mantelhaen.test(dat, correct = FALSE)
a=8*164/229+25*138/213+50*208/346
b=5*52/229+21*29/213+61*27/346
ts=a/b
a=8*164/229+25*138/213+50*208/346
b=5*52/229+21*29/213+61*27/346
ts=a/b
a=8*164/229+25*138/213+50*208/346
b=5*52/229+21*29/213+61*27/346
a/b
dat=array(c(8,52,5,164,
25,29,21,138,
50,27,61,208),
c(2, 2, 3))
mantelhaen.test(dat, correct = FALSE)
dat=array(c(8,52,5,164,
25,29,21,138,
50,27,61,208),
c(2, 2, 3))
mantelhaen.test(dat, correct = FALSE)
pchisq(117.01,2,lower.tail = FALSE)
data = matrix(c(46,25,54,1,99,10),2)
chisq.test(data)
x<-matrix(c(7,7,2,3,
2,8,3,7,
1,5,4,9,
2,8,9,14),4)
chisq.test(x)
x<-matrix(c(7,7,2,3,
2,8,3,7,
1,5,4,9,
2,8,9,14),4)
chisq.test(x)
n1=49
n2=91
p1=n1/1357
p2=n2/1357
OR=p1*(1-p1)/(p2*(1-p2))
logOR=log(OR)
SE = sqrt(1/n1+1/n2+1/(1357-n1)+1/(1357-n2))
CI=exp(logOR+c(-1,1)*SE)
n1=49
n2=91
p1=n1/1357
p2=n2/1357
OR=p1*(1-p1)/(p2*(1-p2))
logOR=log(OR)
SE = sqrt(1/n1+1/n2+1/(1357-n1)+1/(1357-n2))
CI=exp(logOR+c(-1,1)*SE)
OR
logOR
CI
n11=911
n12=4578
n21=579
n22=4219
or=n11*n22/(n12*n21)
se=sqrt(n11+n12+n21+n22)
CI=exp(log(or)+c(-1,1)*se)
n11=911
n12=4578
n21=579
n22=4219
or=n11*n22/(n12*n21)
se=sqrt(n11+n12+n21+n22)
CI=exp(log(or)+c(-1,1)*se)
or
CI
n11=361
n12=4532
n21=246
n22=3775
OR=n11*n22/(n12*n21)
se=sqrt(n11+n12+n21+n22)
CI=exp(log(or)+c(-1,1)*se)
OR
CI
n11=396
n12=6598
n21=219
n22=5261
OR=n11*n22/(n12*n21)
se=sqrt(n11+n12+n21+n22)
CI=exp(log(or)+c(-1,1)*se)
OR
CI
logit(0.5)
log(1)
dat <- matrix(c(44, 77, 56, 43), 2)
chisq.test(dat, correct = FALSE)
dat <- matrix(c(44, 56, 77, 43), 2)
chisq.test(dat, correct = FALSE)
pchisq(17.36,1,lower.tail = F)
data=matix(c(10,8,1,1),2)
data=matrix(c(10,8,1,1),2)
mcnemar.test(data)
data=matrix(c(40,20,16,3),2)
mcnemar.test(data)
n12 = 267
n21 = 135
TS  = (n12-n21)^2/(n12+n21)
pchisq(TS,1,lower.tail = F)
data=matrix(c(2,13,4,15),2)
fisher.test(data,alternative = "less")
data=matrix(c(2,13,4,15),2)
fisher.test(data,alternative = "two.sided")
data=matrix(c(2,13,4,15),2)
fisher.test(data,alternative = "two.sided")
p1=2/15
p2=4/19
p=6/34
ts=(p1-p2)/sqrt(p*(1-p)*(1/15+1/19))
pnorm(ts,lower.tail = FALSE)
p1=2/15
p2=4/19
p=6/34
ts=(p1-p2)/sqrt(p*(1-p)*(1/15+1/19))
2*pnorm(-ts)
pnorm(0.58)
TS <- 0.5863
pnorm(-TS)*2
p1=2/15
p2=4/19
p=6/34
ts=(p1-p2)/sqrt(p*(1-p)*(1/15+1/19))
pnorm(-ts)*2
p1=2/15
p2=4/19
p=6/34
ts = (p1-p2)/sqrt(p*(1-p)*(1/15+1/19))
pnorm(-ts)*2
(p1-p2)/sqrt(p*(1-p)*(1/15+1/19))
-ts
pnorm(-ts)
TS <- 0.5863
pnorm(-TS)*2
p1=2/15
p2=4/19
p=6/34
ts = (p1-p2)/sqrt(p*(1-p)*(1/15+1/19))
TS <- 0.5863
pnorm(-TS)*2
p1=2/15
p2=4/19
p=6/34
ts = (p1-p2)/sqrt(p*(1-p)*(1/15+1/19))
TS <- 0.5863
pnorm(-ts)*2
p1=2/15
p2=4/19
p=6/34
ts = (p1-p2)/sqrt(p*(1-p)*(1/15+1/19))
pnorm(-ts)*2
p1=2/15
p2=4/19
p=6/34
TS = (p1-p2)/sqrt(p*(1-p)*(1/15+1/19))
pnorm(-TS)*2
p1=2/15
p2=4/19
p=6/34
TS = (p1-p2)/sqrt(p*(1-p)*(1/15+1/19))
pnorm(-TS)*2
p1=2/15
p2=4/19
p=6/34
TS = (p1-p2)/sqrt(p*(1-p)*(1/15+1/19))
pnorm(TS)*2
e11=6/34*15
e12=28/34*15
e21=6/34*19
e22=28/34*19
ts=(2-e11)^2/2+(13-e12)^2/13+(4-e21)^2/4+(15-e22)^2/15
pchisq(ts,1,lower.tail = FALSE)
e11=6/34*15
e12=28/34*15
e21=6/34*19
e22=28/34*19
ts=(2-e11)^2/e11+(13-e12)^2/e12+(4-e21)^2/e21+(15-e22)^2/e22
pchisq(ts,1,lower.tail = FALSE)
data=matrix(c(2,13,4,15),2)
fisher.test(data,alternative = "two.sided")
pvalue = choose(15,0)*choose(19,6)/choose(34,6)+choose(15,1)*choose(19,5)/choose(34,6)+choose(15,3)*choose(19,3)/choose(34,6)+choose(15,4)*choose(19,2)/choose(34,6)+choose(15,5)*choose(19,1)/choose(34,6)+choose(15,6)*choose(19,0)/choose(34,6)
pvalue = choose(15,0)*choose(19,6)/choose(34,6)+choose(15,1)*choose(19,5)/choose(34,6)+choose(15,2)*choose(19,4)/choose(34,6)+choose(15,3)*choose(19,3)/choose(34,6)+choose(15,4)*choose(19,2)/choose(34,6)+choose(15,5)*choose(19,1)/choose(34,6)+choose(15,6)*choose(19,0)/choose(34,6)
choose(15,0)*choose(19,6)/choose(34,6)+choose(15,1)*choose(19,5)/choose(34,6)+choose(15,3)*choose(19,3)/choose(34,6)+choose(15,4)*choose(19,2)/choose(34,6)+choose(15,5)*choose(19,1)/choose(34,6)+choose(15,6)*choose(19,0)/choose(34,6)
choose(15,0)*choose(19,6)/choose(34,6)+choose(15,1)*choose(19,5)/choose(34,6)++choose(15,2)*choose(19,4)/choose(34,6)choose(15,3)*choose(19,3)/choose(34,6)+choose(15,4)*choose(19,2)/choose(34,6)+choose(15,5)*choose(19,1)/choose(34,6)+choose(15,6)*choose(19,0)/choose(34,6)
choose(15,0)*choose(19,6)/choose(34,6)+choose(15,1)*choose(19,5)/choose(34,6)+choose(15,2)*choose(19,4)/choose(34,6)+choose(15,3)*choose(19,3)/choose(34,6)+choose(15,4)*choose(19,2)/choose(34,6)+choose(15,5)*choose(19,1)/choose(34,6)+choose(15,6)*choose(19,0)/choose(34,6)
choose(15,0)*choose(19,6)/choose(34,6)+choose(15,1)*choose(19,5)/choose(34,6)+choose(15,2)*choose(19,4)/choose(34,6)+choose(15,4)*choose(19,2)/choose(34,6)+choose(15,5)*choose(19,1)/choose(34,6)+choose(15,6)*choose(19,0)/choose(34,6)
data=matrix(c(2,13,4,15),2)
fisher.test(data,alternative = "two.sided")
choose(15,0)*choose(19,6)/choose(34,6)+choose(15,1)*choose(19,5)/choose(34,6)+choose(15,2)*choose(19,4)/choose(34,6)+choose(15,4)*choose(19,2)/choose(34,6)+choose(15,5)*choose(19,1)/choose(34,6)+choose(15,6)*choose(19,0)/choose(34,6)
dat=array(c(8,52,5,164,
25,29,21,138,
50,27,61,208),
c(2, 2, 3))
mantelhaen.test(dat, correct = FALSE)
a=8*164/229+25*138/213+50*208/346
b=5*52/229+21*29/213+61*27/346
a/b
pchisq(67.99,3,lower.tail = F)
n11=911
n12=4578
n21=579
n22=4219
OR=n11*n22/(n12*n21)
se=sqrt(n11+n12+n21+n22)
CI=exp(log(or)+c(-1,1)*se)
n11=911
n12=4578
n21=579
n22=4219
OR=n11*n22/(n12*n21)
se=sqrt(n11+n12+n21+n22)
CI=exp(log(OR)+c(-1,1)*se)
OR
CI
n11=361
n12=4532
n21=246
n22=3775
OR=n11*n22/(n12*n21)
se=sqrt(n11+n12+n21+n22)
CI=exp(log(or)+c(-1,1)*se)
dat <- read.csv("task1.csv", header = FALSE)
dat2 <- dat[,1 : 10]
dat2 <- dat2[complete.cases(dat2),]
vec1 <- as.vector(unlist(dat2))
chisq.test(dat2, correct = F)
dat <- read.csv("task1.csv", header = FALSE)
dat2 <- dat[,1 : 10]
dat2 <- dat2[complete.cases(dat2),]
vec1 <- as.vector(unlist(dat2))
chisq.test(dat2)
data = matrix(c(46,25,54,1,99,10),2)
chisq.test(data,correct = F)
data = matrix(c(46,25,54,1,99,10),2)
chisq.test(data)
data=matrix(c(445,555,496,504),2)
chisq.test(data,correct = FALSE)
ts=55^2/500+55^2/500+4^2/500+4^2/500
pchisq(ts,1,lower.tail = FALSE)
p = (277+278+227+277)/2000
TS = (p-0.5)/sqrt(0.5*0.5/1059)
p = (277+278+227+277)/2000
TS = (p-0.5)/sqrt(0.5*0.5/1059)
pnorm(TS,lower.tail = F)*2
data = matrix(c(46,25,54,1,99,10),2)
chisq.test(data,correct = FALSE)
data
data = array(c(46,25,54,1,99,10),2)
chisq.test(data,correct = FALSE)
data
data = matrix(c(46,25,54,1,99,10),2)
chisq.test(data,correct = FALSE)
data
data = matrix(c(46,1,25,99,54,10),2)
chisq.test(data,correct = FALSE)
data = matrix(c(46,1,25,99,54,10),2)
chisq.test(data,correct = FALSE)
